<!DOCTYPE html>
<html lang="en">
<head>
    <script>
  const token = localStorage.getItem("token");

  if (!token) {
    // Redirect with query param
    window.location.href = "../../index.html?message=login_required";
  }
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reverse Image Search - imglys</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <!-- Header -->
   <header class="header">
      <div class="container">
        <nav class="navbar">
          <div class="navbar-container">
            <div class="navbar-brand">
              <a href="index.html" class="d-flex align-items-center">
                <img src="/Resource/images/icon.png" alt="imglys Logo">
                <span class="logo-text">imglys</span>
              </a>
            </div>
            <ul class="navbar-nav">
              <li>
                <a href="index.html" class="nav-link active">Home</a>
              </li>
              <li>
                <a href="pages/reverse-search.html" class="nav-link">Reverse Search</a>
              </li>
              <li>
                <a href="pages/bg-remover.html" class="nav-link">BG Remover</a>
              </li>
              <li>
                <a href="pages/logo-maker.html" class="nav-link">Logo Maker</a>
              </li>
              <li>
                <a href="pages/prompt-to-image.html" class="nav-link">Prompt to Image</a>
              </li>
            </ul>
            <div class="dropdown ms-auto">
              <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                <img id="navbar-profile-pic" src="https://via.placeholder.com/32" alt="profile" class="rounded-circle me-2" width="32" height="32">
                <span id="navbar-username" class="fw-semibold">Loading...</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <a class="dropdown-item" href="/pages/account.html">My Account</a>
                </li>
                <li>
                  <a class="dropdown-item" href="#" id="logout-btn">Logout</a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Tool Header -->
        <section class="tool-header">
            <div class="container">
                <h1 class="tool-title">Reverse Image Search</h1>
                <p class="tool-description">Find similar images across the web by uploading your image. Discover where your images are being used or find the original source.</p>
            </div>
        </section>

        <!-- Tool Content -->
        <section class="section">
            <div class="container">
                <div class="tool-container">
                    <!-- Upload Area -->
                    <div id="upload-area" class="upload-area">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h3>Upload Image</h3>
                        <p class="upload-text">Drag and drop your image here or click to browse</p>
                        <p class="text-muted small">Supported formats: JPG, PNG, WebP - Max size: 10MB</p>
                        <input type="file" id="reverse-search-input" class="file-input" accept="image/*">
                    </div>
                    
                    <!-- Preview Container -->
                    <div id="preview-container" class="preview-container">
                        <h3>Your Image</h3>
                        <img id="preview-image" class="preview-image">
                        <button id="search-btn" class="btn btn-primary mt-3">Search for Similar Images</button>
                    </div>
                    
                    <!-- Loading Spinner -->
                    <div id="loading-spinner" class="loading-spinner">
                        <div class="spinner"></div>
                        <p class="mt-3">Searching for similar images...</p>
                    </div>
                    
                    <!-- Error Message -->
                    <div id="error-message" class="alert alert-danger mt-3" style="display: none;"></div>
                    
                    <!-- Results Container -->
                    <div id="results-container" class="result-container">
                        <h3>Search Results</h3>
                        <p>We found these similar images:</p>
                        <div class="search-results"></div>
                    </div>
                </div>
                
                <!-- How It Works Section -->
                <div class="card mt-5">
                    <div class="card-body">
                        <h3>How Reverse Image Search Works</h3>
                        <div class="row mt-4">
                            <div class="col-md-4 text-center mb-4 mb-md-0">
                                <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                                    <i class="fas fa-upload fa-2x" style="color: var(--primary-color);"></i>
                                </div>
                                <h4 class="mt-3">Upload</h4>
                                <p>Upload any image from your device</p>
                            </div>
                            <div class="col-md-4 text-center mb-4 mb-md-0">
                                <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                                    <i class="fas fa-search fa-2x" style="color: var(--primary-color);"></i>
                                </div>
                                <h4 class="mt-3">Analyze</h4>
                                <p>Our AI analyzes the visual content</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <div class="rounded-circle bg-light d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                                    <i class="fas fa-list fa-2x" style="color: var(--primary-color);"></i>
                                </div>
                                <h4 class="mt-3">Results</h4>
                                <p>Get a list of similar images found online</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <img src="../svg/logo.svg" alt="imglys Logo">
                        <span class="logo-text">imglys</span>
                    </div>
                    <p class="footer-description">
                        Advanced AI-powered image tools to help you create, edit, and discover images with ease.
                    </p>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Tools</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="reverse-search.html">Reverse Image Search</a></li>
                        <li class="footer-link"><a href="bg-remover.html">Background Remover</a></li>
                        <li class="footer-link"><a href="logo-maker.html">AI Logo Maker</a></li>
                        <li class="footer-link"><a href="prompt-to-image.html">Prompt to Image</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Resources</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="#">API Documentation</a></li>
                        <li class="footer-link"><a href="#">Tutorials</a></li>
                        <li class="footer-link"><a href="#">Blog</a></li>
                        <li class="footer-link"><a href="#">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Company</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="#">About Us</a></li>
                        <li class="footer-link"><a href="#">Contact</a></li>
                        <li class="footer-link"><a href="#">Privacy Policy</a></li>
                        <li class="footer-link"><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 imglys. All rights reserved.</p>
            </div>
        </div>
    </footer>
 <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const token = localStorage.getItem("token");
        if (!token) return;
        try {
          const res = await fetch("http://localhost:5000/api/profile/me", {
            headers: {
              Authorization: `Bearer ${token}`,
            },
          });
          const data = await res.json();
          console.log(data);
          if (res.ok) {
            // Set username
            document.getElementById("navbar-username").textContent = data.name;
            // Set profile picture
            if (data.profilePicture) {
              document.getElementById("navbar-profile-pic").src = data.profilePicture;
            }
            // Update subscription status text and upgrade button visibility
            const currentPlan = data.plan || "Free";
            const formattedPlan = currentPlan.charAt(0).toUpperCase() + currentPlan.slice(1).toLowerCase();
            subStatusText.textContent = formattedPlan;
            const plansToShowUpgrade = ["free", "pro"];
            if (plansToShowUpgrade.includes(currentPlan.toLowerCase())) {
              upgradeMenuItem.style.display = "block";
            } else {
              upgradeMenuItem.style.display = "none";
            }
          }
        } catch (err) {
          console.error("Profile fetch failed", err);
        }
      });
    </script>
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="../js/main.js"></script>
    <script src="../js/tools.js"></script>
</body>
</html>